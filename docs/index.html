<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>로스팅 일기 - 커피 로스팅 데이터 분석 및 기록</title>
    <meta name="description" content="커피 로스팅 데이터 분석, 생두 구매 기록, 로스팅 로그를 한곳에서 관리하세요. 전문적인 로스팅 분석 도구로 커피의 품질을 극대화하세요.">
    <meta name="keywords" content="커피로스팅, 로스팅분석, 생두구매, 로스팅로그, 스페셜티커피, 커피리뷰">
    <meta name="author" content="Roasting Analysis">
    
    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://yourdomain.com/">
    <meta property="og:title" content="로스팅 일기 - 커피 로스팅 데이터 분석">
    <meta property="og:description" content="커피 로스팅 데이터 분석, 생두 구매 기록, 로스팅 로그를 한곳에서 관리하세요.">
    <meta property="og:image" content="https://yourdomain.com/images/og-image.jpg">
    
    <!-- Twitter -->
    <meta property="twitter:card" content="summary_large_image">
    <meta property="twitter:url" content="https://yourdomain.com/">
    <meta property="twitter:title" content="로스팅 일기 - 커피 로스팅 데이터 분석">
    <meta property="twitter:description" content="커피 로스팅 데이터 분석, 생두 구매 기록, 로스팅 로그를 한곳에서 관리하세요.">
    <meta property="twitter:image" content="https://yourdomain.com/images/og-image.jpg">
    
    <!-- Canonical URL -->
    <link rel="canonical" href="https://yourdomain.com/">
    
    <!-- Favicon -->
    <link rel="icon" type="image/x-icon" href="favicon.ico">
    
    <!-- Google Analytics (GA4) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-HRLZHE8M40"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'G-HRLZHE8M40');
    </script>
    
    <!-- Structured Data (JSON-LD) -->
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "WebSite",
      "name": "로스팅 일기",
      "url": "https://yourdomain.com/",
      "description": "커피 로스팅 데이터 분석 및 기록 플랫폼",
      "publisher": {
        "@type": "Person",
        "name": "Roasting Analysis"
      },
      "potentialAction": {
        "@type": "SearchAction",
        "target": "https://yourdomain.com/search?q={search_term_string}",
        "query-input": "required name=search_term_string"
      }
    }
    </script>
    
    <link rel="stylesheet" href="css/elementary.css">
    <style>
        .pagination {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 0.5rem;
            margin-top: 1.5rem;
            flex-wrap: wrap;
        }
        .pagination button {
            background: transparent;
            border: 1px solid rgba(191, 191, 191, 0.3);
            color: rgb(191, 191, 191);
            padding: 0.4rem 0.8rem;
            cursor: pointer;
            transition: all 0.2s;
            font-size: 0.9rem;
        }
        .pagination button:hover:not(:disabled) {
            background: rgba(191, 191, 191, 0.1);
            border-color: rgba(191, 191, 191, 0.5);
        }
        .pagination button:disabled {
            opacity: 0.3;
            cursor: not-allowed;
        }
        .pagination button.active {
            background: rgba(255, 77, 109, 0.2);
            border-color: #ff4d6d;
            color: #ff4d6d;
        }
        .pagination-info {
            color: rgba(191, 191, 191, 0.6);
            font-size: 0.85rem;
            margin-left: 1rem;
        }
    </style>
</head>
<body class="dark">
    <div class="container">
        <!-- <nav class="top-nav">
            <a class="nav-item" href='index.html'>Home</a>
        </nav> -->

        <hr class="stylish"/>
        
        <header>
            <h1>로스팅 일기</h1>
        </header>

        <hr class="stylish"/>

        <main class="home-main">
            <section id="posts">
                <details open>
                    <summary>
                        <h3 class="home-page-heading">로스팅기록</h3>
                    </summary>
                    <div class="parent" id="roastingList">
                        <!-- 로스팅 데이터 목록이 여기에 렌더링됩니다 -->
                    </div>
                    <div class="pagination" id="roastingPagination"></div>
                </details>
            </section>
            <section id="posts">
                <details close>
                    <summary>
                        <h3 class="home-page-heading">생두구매기록</h3>
                    </summary>
                    <div class="parent" id="shopList">
                        <!-- 로스팅 데이터 목록이 여기에 렌더링됩니다 -->
                    </div>
                    <div class="pagination" id="shopPagination"></div>
                </details>
            </section>
            <section id="posts">
                <details close>
                    <summary>
                        <h3 class="home-page-heading">카페 스페셜티 리뷰</h3>
                    </summary>
                    <div class="parent">
                        <div class="post-wrapper">
                            <a href="specialty-review.html">스페셜티 원두 테이스팅 노트</a>
                        </div>
                    </div>
                </details>
            </section>
        </main>
    </div>

    <footer>
        <hr class="stylish"/>
        <!-- <nav class="top-nav">
            <a class="nav-item" href='index.html'>Home</a>
        </nav> -->
        <div>
            Theme: <a href="https://github.com/abhn/Elementary">Elementary</a>
        </div>
    </footer>

    <script>
        const ITEMS_PER_PAGE = 10;

        // 로스팅 리스트 페이지네이션 상태
        let roastingData = [];
        let roastingCurrentPage = 1;

        // 생두 리스트 페이지네이션 상태
        let beanData = [];
        let beanCurrentPage = 1;

        window.addEventListener('DOMContentLoaded', loadRoastingList);
        window.addEventListener('DOMContentLoaded', loadBeanList);

        async function loadRoastingList() {
            const list = document.getElementById('roastingList');

            try {
                const response = await fetch('roastingData/index.json');
                if (!response.ok) {
                    throw new Error('로스팅 데이터를 불러올 수 없습니다.');
                }
                roastingData = await response.json();

                if (roastingData.length === 0) {
                    list.innerHTML = `
                        <div style="text-align: center; padding: 2rem; color: #8b949e;">
                            <div>저장된 데이터가 없습니다.</div>
                        </div>
                    `;
                } else {
                    // id 기준 내림차순 정렬
                    roastingData.sort((a, b) => parseInt(b.id) - parseInt(a.id));
                    roastingCurrentPage = 1;
                    renderRoastingList();
                }
            } catch (error) {
                list.innerHTML = `
                    <div style="text-align: center; padding: 2rem; color: #ff6b6b;">
                        <div>${error.message}</div>
                    </div>
                `;
            }
        }

        function renderRoastingList() {
            const list = document.getElementById('roastingList');
            const pagination = document.getElementById('roastingPagination');

            const totalPages = Math.ceil(roastingData.length / ITEMS_PER_PAGE);
            const start = (roastingCurrentPage - 1) * ITEMS_PER_PAGE;
            const end = start + ITEMS_PER_PAGE;
            const pageItems = roastingData.slice(start, end);

            list.innerHTML = pageItems.map(f => `
                <div class="post-wrapper">
                    <a href="roasting/${f.id}.html">[${f.id}] ${f.name}</a>
                </div>
            `).join('');

            renderPagination(pagination, roastingCurrentPage, totalPages, roastingData.length, (page) => {
                roastingCurrentPage = page;
                renderRoastingList();
            });
        }

        async function loadBeanList() {
            const list = document.getElementById('shopList');

            try {
                const response = await fetch('beanData/index.json');
                if (!response.ok) {
                    throw new Error('생두 데이터를 불러올 수 없습니다.');
                }
                beanData = await response.json();

                if (beanData.length === 0) {
                    list.innerHTML = `
                        <div style="text-align: center; padding: 2rem; color: #8b949e;">
                            <div>저장된 데이터가 없습니다.</div>
                        </div>
                    `;
                } else {
                    // 날짜 기준 내림차순 정렬 (최신순)
                    beanData.sort((a, b) => new Date(b.date) - new Date(a.date));
                    beanCurrentPage = 1;
                    renderBeanList();
                }
            } catch (error) {
                list.innerHTML = `
                    <div style="text-align: center; padding: 2rem; color: #ff6b6b;">
                        <div>${error.message}</div>
                    </div>
                `;
            }
        }

        function renderBeanList() {
            const list = document.getElementById('shopList');
            const pagination = document.getElementById('shopPagination');

            const totalPages = Math.ceil(beanData.length / ITEMS_PER_PAGE);
            const start = (beanCurrentPage - 1) * ITEMS_PER_PAGE;
            const end = start + ITEMS_PER_PAGE;
            const pageItems = beanData.slice(start, end);

            list.innerHTML = pageItems.map(b => {
                const displayName = `${b.date || ''} ${b.distributor || ''} ${b.name || ''} ${b.price || 0}원`.trim();
                const beanId = b.file.replace('.json', '');
                return `
                    <div class="post-wrapper">
                        <a href="bean.html?id=${beanId}" target="_blank">${displayName}</a>
                    </div>
                `;
            }).join('');

            renderPagination(pagination, beanCurrentPage, totalPages, beanData.length, (page) => {
                beanCurrentPage = page;
                renderBeanList();
            });
        }

        function renderPagination(container, currentPage, totalPages, totalItems, onPageChange) {
            if (totalPages <= 1) {
                container.innerHTML = '';
                return;
            }

            let html = '';

            // 이전 버튼
            html += `<button ${currentPage === 1 ? 'disabled' : ''} onclick="event.preventDefault(); this.dispatchEvent(new CustomEvent('page-change', {detail: ${currentPage - 1}}))">← 이전</button>`;

            // 페이지 번호
            const maxVisiblePages = 5;
            let startPage = Math.max(1, currentPage - Math.floor(maxVisiblePages / 2));
            let endPage = Math.min(totalPages, startPage + maxVisiblePages - 1);

            if (endPage - startPage + 1 < maxVisiblePages) {
                startPage = Math.max(1, endPage - maxVisiblePages + 1);
            }

            if (startPage > 1) {
                html += `<button onclick="event.preventDefault(); this.dispatchEvent(new CustomEvent('page-change', {detail: 1}))">1</button>`;
                if (startPage > 2) {
                    html += `<span style="color: rgba(191,191,191,0.5);">...</span>`;
                }
            }

            for (let i = startPage; i <= endPage; i++) {
                html += `<button class="${i === currentPage ? 'active' : ''}" onclick="event.preventDefault(); this.dispatchEvent(new CustomEvent('page-change', {detail: ${i}}))">${i}</button>`;
            }

            if (endPage < totalPages) {
                if (endPage < totalPages - 1) {
                    html += `<span style="color: rgba(191,191,191,0.5);">...</span>`;
                }
                html += `<button onclick="event.preventDefault(); this.dispatchEvent(new CustomEvent('page-change', {detail: ${totalPages}}))">${totalPages}</button>`;
            }

            // 다음 버튼
            html += `<button ${currentPage === totalPages ? 'disabled' : ''} onclick="event.preventDefault(); this.dispatchEvent(new CustomEvent('page-change', {detail: ${currentPage + 1}}))">다음 →</button>`;

            // 페이지 정보
            html += `<span class="pagination-info">총 ${totalItems}개</span>`;

            container.innerHTML = html;

            // 이벤트 리스너 등록
            container.querySelectorAll('button').forEach(btn => {
                btn.addEventListener('page-change', (e) => {
                    onPageChange(e.detail);
                });
            });
        }
    </script>
</body>
</html>
